session_name: ssh-update-servers
windows:
- window_name: main window
  layout: tiled
  shell_command_before:
    - cd ~/nix-config # run as a first command in all panes
  panes:
    - shell_command: # pane no. 1
      - ssh 172.16.255.1
      - cd ~/nix-config
      - git stash
      - git pull
      - un
      - reboot
    - shell_command: # pane no. 2
      - ssh 172.16.255.2
      - cd ~/nix-config
      - git stash
      - git pull
      - un
      - reboot
    - shell_command: # pane no. 3
      - ssh 172.16.255.3
      - cd ~/nix-config
      - git stash
      - git pull
      - sudo nix flake update
      - un
      - reboot
    - shell_command: # pane no. 4
      - ssh 172.16.255.4
      - cd ~/nix-config
      - git stash
      - git pull
      - un
      - reboot